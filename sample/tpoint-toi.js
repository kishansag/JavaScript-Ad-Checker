(function(){var t="0.4.5",j=window.jQuery||window.$||(window.$={}),f={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(F){return String(F).evalJSON()}||j.parseJSON||j.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||j.toJSON};if(!("parse"in f)||!("stringify"in f)){throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page")}var m={__jstorage_meta:{CRC32:{}}},c={jStorage:"{}"},y=null,o=0,i=false,k={},C=false,z=0,s={},x=+new Date(),A,B={isXML:function(G){var F=(G?G.ownerDocument||G:0).documentElement;return F?F.nodeName!=="HTML":false},encode:function(G){if(!this.isXML(G)){return false}try{return new XMLSerializer().serializeToString(G)}catch(F){try{return G.xml}catch(H){}}return false},decode:function(G){var F=("DOMParser"in window&&(new DOMParser()).parseFromString)||(window.ActiveXObject&&function(I){var J=new ActiveXObject("Microsoft.XMLDOM");J.async="false";J.loadXML(I);return J}),H;if(!F){return false}H=F.call("DOMParser"in window&&(new DOMParser())||window,G,"text/xml");return this.isXML(H)?H:false}};function q(){var F=false;if("localStorage"in window){try{window.localStorage.setItem("_tmptest","tmpval");F=true;window.localStorage.removeItem("_tmptest")}catch(G){}}if(F){try{if(window.localStorage){c=window.localStorage;i="localStorage";z=c.jStorage_update}}catch(M){}}else{if("globalStorage"in window){try{if(window.globalStorage){if(window.location.hostname=="localhost"){c=window.globalStorage["localhost.localdomain"]}else{c=window.globalStorage[window.location.hostname]}i="globalStorage";z=c.jStorage_update}}catch(L){}}else{y=document.createElement("link");if(y.addBehavior){y.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(y);try{y.load("jStorage")}catch(K){y.setAttribute("jStorage","{}");y.save("jStorage");y.load("jStorage")}var J="{}";try{J=y.getAttribute("jStorage")}catch(I){}try{z=y.getAttribute("jStorage_update")}catch(H){}c.jStorage=J;i="userDataBehavior"}else{y=null;return}}}l();b();w();u();if("addEventListener"in window){window.addEventListener("pageshow",function(N){if(N.persisted){p()}},false)}}function e(){var H="{}";if(i=="userDataBehavior"){y.load("jStorage");try{H=y.getAttribute("jStorage")}catch(G){}try{z=y.getAttribute("jStorage_update")}catch(F){}c.jStorage=H}l();b();u()}function w(){if(i=="localStorage"||i=="globalStorage"){if("addEventListener"in window){window.addEventListener("storage",p,false)}else{document.attachEvent("onstorage",p)}}else{if(i=="userDataBehavior"){setInterval(p,1000)}}}function p(){var F;clearTimeout(C);C=setTimeout(function(){if(i=="localStorage"||i=="globalStorage"){F=c.jStorage_update}else{if(i=="userDataBehavior"){y.load("jStorage");try{F=y.getAttribute("jStorage_update")}catch(G){}}}if(F&&F!=z){z=F;h()}},25)}function h(){var F=f.parse(f.stringify(m.__jstorage_meta.CRC32)),J;e();J=f.parse(f.stringify(m.__jstorage_meta.CRC32));var H,G=[],I=[];for(H in F){if(F.hasOwnProperty(H)){if(!J[H]){I.push(H);continue}if(F[H]!=J[H]&&String(F[H]).substr(0,2)=="2."){G.push(H)}}}for(H in J){if(J.hasOwnProperty(H)){if(!F[H]){G.push(H)}}}E(G,"updated");E(I,"deleted")}function E(K,L){K=[].concat(K||[]);if(L=="flushed"){K=[];for(var J in k){if(k.hasOwnProperty(J)){K.push(J)}}L="deleted"}for(var I=0,F=K.length;I<F;I++){if(k[K[I]]){for(var H=0,G=k[K[I]].length;H<G;H++){k[K[I]][H](K[I],L)}}if(k["*"]){for(var H=0,G=k["*"].length;H<G;H++){k["*"][H](K[I],L)}}}}function n(){var G=(+new Date()).toString();if(i=="localStorage"||i=="globalStorage"){try{c.jStorage_update=G}catch(F){i=false}}else{if(i=="userDataBehavior"){y.setAttribute("jStorage_update",G);y.save("jStorage")}}p()}function l(){if(c.jStorage){try{m=f.parse(String(c.jStorage))}catch(F){c.jStorage="{}"}}else{c.jStorage="{}"}o=c.jStorage?String(c.jStorage).length:0;if(!m.__jstorage_meta){m.__jstorage_meta={}}if(!m.__jstorage_meta.CRC32){m.__jstorage_meta.CRC32={}}}function r(){a();try{c.jStorage=f.stringify(m);if(y){y.setAttribute("jStorage",c.jStorage);y.save("jStorage")}o=c.jStorage?String(c.jStorage).length:0}catch(F){}}function v(F){if(!F||(typeof F!="string"&&typeof F!="number")){throw new TypeError("Key name must be string or numeric")}if(F=="__jstorage_meta"){throw new TypeError("Reserved key name")}return true}function b(){var L,G,J,H,I=Infinity,K=false,F=[];clearTimeout(A);if(!m.__jstorage_meta||typeof m.__jstorage_meta.TTL!="object"){return}L=+new Date();J=m.__jstorage_meta.TTL;H=m.__jstorage_meta.CRC32;for(G in J){if(J.hasOwnProperty(G)){if(J[G]<=L){delete J[G];delete H[G];delete m[G];K=true;F.push(G)}else{if(J[G]<I){I=J[G]}}}}if(I!=Infinity){A=setTimeout(b,I-L)}if(K){r();n();E(F,"deleted")}}function u(){var I,G;if(!m.__jstorage_meta.PubSub){return}var F,H=x;for(I=G=m.__jstorage_meta.PubSub.length-1;I>=0;I--){F=m.__jstorage_meta.PubSub[I];if(F[0]>x){H=F[0];d(F[1],F[2])}}x=H}function d(H,J){if(s[H]){for(var G=0,F=s[H].length;G<F;G++){try{s[H][G](H,f.parse(f.stringify(J)))}catch(I){}}}}function a(){if(!m.__jstorage_meta.PubSub){return}var H=+new Date()-2000;for(var G=0,F=m.__jstorage_meta.PubSub.length;G<F;G++){if(m.__jstorage_meta.PubSub[G][0]<=H){m.__jstorage_meta.PubSub.splice(G,m.__jstorage_meta.PubSub.length-G);break}}if(!m.__jstorage_meta.PubSub.length){delete m.__jstorage_meta.PubSub}}function g(F,G){if(!m.__jstorage_meta){m.__jstorage_meta={}}if(!m.__jstorage_meta.PubSub){m.__jstorage_meta.PubSub=[]}m.__jstorage_meta.PubSub.unshift([+new Date,F,G]);r();n()}function D(K,G){var F=K.length,J=G^F,I=0,H;while(F>=4){H=((K.charCodeAt(I)&255))|((K.charCodeAt(++I)&255)<<8)|((K.charCodeAt(++I)&255)<<16)|((K.charCodeAt(++I)&255)<<24);H=(((H&65535)*1540483477)+((((H>>>16)*1540483477)&65535)<<16));H^=H>>>24;H=(((H&65535)*1540483477)+((((H>>>16)*1540483477)&65535)<<16));J=(((J&65535)*1540483477)+((((J>>>16)*1540483477)&65535)<<16))^H;F-=4;++I}switch(F){case 3:J^=(K.charCodeAt(I+2)&255)<<16;case 2:J^=(K.charCodeAt(I+1)&255)<<8;case 1:J^=(K.charCodeAt(I)&255);J=(((J&65535)*1540483477)+((((J>>>16)*1540483477)&65535)<<16))}J^=J>>>13;J=(((J&65535)*1540483477)+((((J>>>16)*1540483477)&65535)<<16));J^=J>>>15;return J>>>0}j.jStorage={version:t,set:function(G,H,F){v(G);F=F||{};if(typeof H=="undefined"){this.deleteKey(G);return H}if(B.isXML(H)){H={_is_xml:true,xml:B.encode(H)}}else{if(typeof H=="function"){return undefined}else{if(H&&typeof H=="object"){H=f.parse(f.stringify(H))}}}m[G]=H;m.__jstorage_meta.CRC32[G]="2."+D(f.stringify(H),2538058380);this.setTTL(G,F.TTL||0);E(G,"updated");return H},get:function(F,G){v(F);if(F in m){if(m[F]&&typeof m[F]=="object"&&m[F]._is_xml){return B.decode(m[F].xml)}else{return m[F]}}return typeof(G)=="undefined"?null:G},deleteKey:function(F){v(F);if(F in m){delete m[F];if(typeof m.__jstorage_meta.TTL=="object"&&F in m.__jstorage_meta.TTL){delete m.__jstorage_meta.TTL[F]}delete m.__jstorage_meta.CRC32[F];r();n();E(F,"deleted");return true}return false},setTTL:function(G,F){var H=+new Date();v(G);F=Number(F)||0;if(G in m){if(!m.__jstorage_meta.TTL){m.__jstorage_meta.TTL={}}if(F>0){m.__jstorage_meta.TTL[G]=H+F}else{delete m.__jstorage_meta.TTL[G]}r();b();n();return true}return false},getTTL:function(G){var H=+new Date(),F;v(G);if(G in m&&m.__jstorage_meta.TTL&&m.__jstorage_meta.TTL[G]){F=m.__jstorage_meta.TTL[G]-H;return F||0}return 0},flush:function(){m={__jstorage_meta:{CRC32:{}}};r();n();E(null,"flushed");return true},storageObj:function(){function G(){}G.prototype=m;return new G()},index:function(){var F=[],G;for(G in m){if(m.hasOwnProperty(G)&&G!="__jstorage_meta"){F.push(G)}}return F},storageSize:function(){return o},currentBackend:function(){return i},storageAvailable:function(){return!!i},listenKeyChange:function(F,G){v(F);if(!k[F]){k[F]=[]}k[F].push(G)},stopListening:function(G,H){v(G);if(!k[G]){return}if(!H){delete k[G];return}for(var F=k[G].length-1;F>=0;F--){if(k[G][F]==H){k[G].splice(F,1)}}},subscribe:function(F,G){F=(F||"").toString();if(!F){throw new TypeError("Channel not defined")}if(!s[F]){s[F]=[]}s[F].push(G)},publish:function(F,G){F=(F||"").toString();if(!F){throw new TypeError("Channel not defined")}g(F,G)},reInit:function(){e()}};q()})();var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(b){escapable.lastIndex=0;return escapable.test(b)?'"'+b.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function str(a,b){var i,k,v,length,mind=gap,partial,value=b[a];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(a)}if(typeof rep==="function"){value=rep.call(b,a,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(a,b,c){var i;gap="";indent="";if(typeof c==="number"){for(i=0;i<c;i+=1){indent+=" "}}else{if(typeof c==="string"){indent=c}}rep=b;if(b&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":a})}}if(typeof JSON.parse!=="function"){JSON.parse=function(c,d){var j;function walk(a,b){var k,v,value=a[b];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return d.call(a,b,value)}c=String(c);e.lastIndex=0;if(e.test(c)){c=c.replace(e,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+c+")");return typeof d==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(a,b){var c={};b(c);a.Mustache=c}(this,function(a){var e=/\s*/;var l=/\s+/;var j=/\S/;var h=/\s*=/;var n=/\s*\}/;var t=/#|\^|\/|>|\{|&|=|!/;var f=RegExp.prototype.test;function s(z,y){return f.call(z,y)}function g(y){return!s(j,y)}var v=Object.prototype.toString;var k=Array.isArray||function(y){return v.call(y)==="[object Array]"};function d(y){return y.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function m(y){return String(y).replace(/[&<>"'\/]/g,function(z){return c[z]})}function u(y){this.string=y;this.tail=y;this.pos=0}u.prototype.eos=function(){return this.tail===""};u.prototype.scan=function(z){var y=this.tail.match(z);if(y&&y.index===0){this.tail=this.tail.substring(y[0].length);this.pos+=y[0].length;return y[0]}return""};u.prototype.scanUntil=function(z){var y,A=this.tail.search(z);switch(A){case-1:y=this.tail;this.pos+=this.tail.length;this.tail="";break;case 0:y="";break;default:y=this.tail.substring(0,A);this.tail=this.tail.substring(A);this.pos+=A}return y};function r(y,z){this.view=y||{};this.parent=z;this._cache={}}r.make=function(y){return(y instanceof r)?y:new r(y)};r.prototype.push=function(y){return new r(y,this)};r.prototype.lookup=function(y){var B=this._cache[y];if(!B){if(y=="."){B=this.view}else{var A=this;while(A){if(y.indexOf(".")>0){B=A.view;var C=y.split("."),z=0;while(B&&z<C.length){B=B[C[z++]]}}else{B=A.view[y]}if(B!=null){break}A=A.parent}}this._cache[y]=B}if(typeof B==="function"){B=B.call(this.view)}return B};function p(){this.clearCache()}p.prototype.clearCache=function(){this._cache={};this._partialCache={}};p.prototype.compile=function(A,y){var z=this._cache[A];if(!z){var B=a.parse(A,y);z=this._cache[A]=this.compileTokens(B,A)}return z};p.prototype.compilePartial=function(z,B,y){var A=this.compile(B,y);this._partialCache[z]=A;return A};p.prototype.getPartial=function(y){if(!(y in this._partialCache)&&this._loadPartial){this.compilePartial(y,this._loadPartial(y))}return this._partialCache[y]};p.prototype.compileTokens=function(A,z){var y=this;return function(B,D){if(D){if(typeof D==="function"){y._loadPartial=D}else{for(var C in D){y.compilePartial(C,D[C])}}}return o(A,y,r.make(B),z)}};p.prototype.render=function(A,y,z){return this.compile(A)(y,z)};function o(F,z,y,I){var C="";var A,G,H;for(var D=0,E=F.length;D<E;++D){A=F[D];G=A[1];switch(A[0]){case"#":H=y.lookup(G);if(typeof H==="object"){if(k(H)){for(var B=0,K=H.length;B<K;++B){C+=o(A[4],z,y.push(H[B]),I)}}else{if(H){C+=o(A[4],z,y.push(H),I)}}}else{if(typeof H==="function"){var J=I==null?null:I.slice(A[3],A[5]);H=H.call(y.view,J,function(L){return z.render(L,y)});if(H!=null){C+=H}}else{if(H){C+=o(A[4],z,y,I)}}}break;case"^":H=y.lookup(G);if(!H||(k(H)&&H.length===0)){C+=o(A[4],z,y,I)}break;case">":H=z.getPartial(G);if(typeof H==="function"){C+=H(y)}break;case"&":H=y.lookup(G);if(H!=null){C+=H}break;case"name":H=y.lookup(G);if(H!=null){C+=a.escape(H)}break;case"text":C+=G;break}}return C}function x(E){var z=[];var D=z;var F=[];var B;for(var A=0,y=E.length;A<y;++A){B=E[A];switch(B[0]){case"#":case"^":F.push(B);D.push(B);D=B[4]=[];break;case"/":var C=F.pop();C[5]=B[2];D=F.length>0?F[F.length-1][4]:z;break;default:D.push(B)}}return z}function b(D){var A=[];var C,z;for(var B=0,y=D.length;B<y;++B){C=D[B];if(C){if(C[0]==="text"&&z&&z[0]==="text"){z[1]+=C[1];z[3]=C[3]}else{z=C;A.push(C)}}}return A}function q(y){return[new RegExp(d(y[0])+"\\s*"),new RegExp("\\s*"+d(y[1]))]}function w(O,E){O=O||"";E=E||a.tags;if(typeof E==="string"){E=E.split(l)}if(E.length!==2){throw new Error("Invalid tags: "+E.join(", "))}var I=q(E);var A=new u(O);var G=[];var F=[];var D=[];var P=false;var N=false;function M(){if(P&&!N){while(D.length){delete F[D.pop()]}}else{D=[]}P=false;N=false}var B,z,H,J,C;while(!A.eos()){B=A.pos;H=A.scanUntil(I[0]);if(H){for(var K=0,L=H.length;K<L;++K){J=H.charAt(K);if(g(J)){D.push(F.length)}else{N=true}F.push(["text",J,B,B+1]);B+=1;if(J=="\n"){M()}}}if(!A.scan(I[0])){break}P=true;z=A.scan(t)||"name";A.scan(e);if(z==="="){H=A.scanUntil(h);A.scan(h);A.scanUntil(I[1])}else{if(z==="{"){H=A.scanUntil(new RegExp("\\s*"+d("}"+E[1])));A.scan(n);A.scanUntil(I[1]);z="&"}else{H=A.scanUntil(I[1])}}if(!A.scan(I[1])){throw new Error("Unclosed tag at "+A.pos)}C=[z,H,B,A.pos];F.push(C);if(z==="#"||z==="^"){G.push(C)}else{if(z==="/"){if(G.length===0){throw new Error('Unopened section "'+H+'" at '+B)}var y=G.pop();if(y[1]!==H){throw new Error('Unclosed section "'+y[1]+'" at '+B)}}else{if(z==="name"||z==="{"||z==="&"){N=true}else{if(z==="="){E=H.split(l);if(E.length!==2){throw new Error("Invalid tags at "+B+": "+E.join(", "))}I=q(E)}}}}}var y=G.pop();if(y){throw new Error('Unclosed section "'+y[1]+'" at '+A.pos)}F=b(F);return x(F)}a.name="mustache.js";a.version="0.7.2";a.tags=["{{","}}"];a.Scanner=u;a.Context=r;a.Writer=p;a.parse=w;a.escape=m;var i=new p();a.clearCache=function(){return i.clearCache()};a.compile=function(z,y){return i.compile(z,y)};a.compilePartial=function(z,A,y){return i.compilePartial(z,A,y)};a.compileTokens=function(z,y){return i.compileTokens(z,y)};a.render=function(A,y,z){return i.render(A,y,z)};a.to_html=function(B,z,A,C){var y=a.render(B,z,A);if(typeof C==="function"){C(y)}else{return y}}}));!function(t){var e={},s={mode:"horizontal",slideSelector:"",infiniteLoop:!0,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:!1,startText:"Start",stopText:"Stop",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",autoHover:!1,autoDelay:0,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,onSliderLoad:function(){},onSlideBefore:function(){},onSlideAfter:function(){},onSlideNext:function(){},onSlidePrev:function(){}};t.fn.bxSlider=function(n){if(0==this.length)return this;if(this.length>1)return this.each(function(){t(this).bxSlider(n)}),this;var o={},r=this;e.el=this;var a=t(window).width(),l=t(window).height(),d=function(){o.settings=t.extend({},s,n),o.settings.slideWidth=parseInt(o.settings.slideWidth),o.children=r.children(o.settings.slideSelector),o.children.length<o.settings.minSlides&&(o.settings.minSlides=o.children.length),o.children.length<o.settings.maxSlides&&(o.settings.maxSlides=o.children.length),o.settings.randomStart&&(o.settings.startSlide=Math.floor(Math.random()*o.children.length)),o.active={index:o.settings.startSlide},o.carousel=o.settings.minSlides>1||o.settings.maxSlides>1,o.carousel&&(o.settings.preloadImages="all"),o.minThreshold=o.settings.minSlides*o.settings.slideWidth+(o.settings.minSlides-1)*o.settings.slideMargin,o.maxThreshold=o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin,o.working=!1,o.controls={},o.interval=null,o.animProp="vertical"==o.settings.mode?"top":"left",o.usingCSS=o.settings.useCSS&&"fade"!=o.settings.mode&&function(){var t=document.createElement("div"),e=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in e)if(void 0!==t.style[e[i]])return o.cssPrefix=e[i].replace("Perspective","").toLowerCase(),o.animProp="-"+o.cssPrefix+"-transform",!0;return!1}(),"vertical"==o.settings.mode&&(o.settings.maxSlides=o.settings.minSlides),r.data("origStyle",r.attr("style")),r.children(o.settings.slideSelector).each(function(){t(this).data("origStyle",t(this).attr("style"))}),c()},c=function(){r.wrap('<div class="bx-wrapper"><div class="bx-viewport"></div></div>'),o.viewport=r.parent(),o.loader=t('<div class="bx-loading" />'),o.viewport.prepend(o.loader),r.css({width:"horizontal"==o.settings.mode?100*o.children.length+215+"%":"auto",position:"relative"}),o.usingCSS&&o.settings.easing?r.css("-"+o.cssPrefix+"-transition-timing-function",o.settings.easing):o.settings.easing||(o.settings.easing="swing"),f(),o.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),o.viewport.parent().css({maxWidth:v()}),o.settings.pager||o.viewport.parent().css({margin:"0 auto 0px"}),o.children.css({"float":"horizontal"==o.settings.mode?"left":"none",listStyle:"none",position:"relative"}),o.children.css("width",u()),"horizontal"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginRight",o.settings.slideMargin),"vertical"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginBottom",o.settings.slideMargin),"fade"==o.settings.mode&&(o.children.css({position:"absolute",zIndex:0,display:"none"}),o.children.eq(o.settings.startSlide).css({zIndex:50,display:"block"})),o.controls.el=t('<div class="bx-controls" />'),o.settings.captions&&P(),o.active.last=o.settings.startSlide==x()-1,o.settings.video&&r.fitVids();var e=o.children.eq(o.settings.startSlide);"all"==o.settings.preloadImages&&(e=o.children),o.settings.ticker?o.settings.pager=!1:(o.settings.pager&&T(),o.settings.controls&&C(),o.settings.auto&&o.settings.autoControls&&E(),(o.settings.controls||o.settings.autoControls||o.settings.pager)&&o.viewport.after(o.controls.el)),g(e,h)},g=function(e,i){var s=e.find("img, iframe").length;if(0==s)return i(),void 0;var n=0;e.find("img, iframe").each(function(){t(this).one("load",function(){++n==s&&i()}).each(function(){this.complete&&t(this).load()})})},h=function(){if(o.settings.infiniteLoop&&"fade"!=o.settings.mode&&!o.settings.ticker){var e="vertical"==o.settings.mode?o.settings.minSlides:o.settings.maxSlides,i=o.children.slice(0,e).clone().addClass("bx-clone"),s=o.children.slice(-e).clone().addClass("bx-clone");r.append(i).prepend(s)}o.loader.remove(),S(),"vertical"==o.settings.mode&&(o.settings.adaptiveHeight=!0),o.viewport.height(p()),r.redrawSlider(),o.settings.onSliderLoad(o.active.index),o.initialized=!0,o.settings.responsive&&t(window).bind("resize",B),o.settings.auto&&o.settings.autoStart&&H(),o.settings.ticker&&L(),o.settings.pager&&I(o.settings.startSlide),o.settings.controls&&W(),o.settings.touchEnabled&&!o.settings.ticker&&O()},p=function(){var e=0,s=t();if("vertical"==o.settings.mode||o.settings.adaptiveHeight)if(o.carousel){var n=1==o.settings.moveSlides?o.active.index:o.active.index*m();for(s=o.children.eq(n),i=1;i<=o.settings.maxSlides-1;i++)s=n+i>=o.children.length?s.add(o.children.eq(i-1)):s.add(o.children.eq(n+i))}else s=o.children.eq(o.active.index);else s=o.children;return"vertical"==o.settings.mode?(s.each(function(){e+=t(this).outerHeight()}),o.settings.slideMargin>0&&(e+=o.settings.slideMargin*(o.settings.minSlides-1))):e=Math.max.apply(Math,s.map(function(){return t(this).outerHeight(!1)}).get()),e},v=function(){var t="100%";return o.settings.slideWidth>0&&(t="horizontal"==o.settings.mode?o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin:o.settings.slideWidth),t},u=function(){var t=o.settings.slideWidth,e=o.viewport.width();return 0==o.settings.slideWidth||o.settings.slideWidth>e&&!o.carousel||"vertical"==o.settings.mode?t=e:o.settings.maxSlides>1&&"horizontal"==o.settings.mode&&(e>o.maxThreshold||e<o.minThreshold&&(t=(e-o.settings.slideMargin*(o.settings.minSlides-1))/o.settings.minSlides)),t},f=function(){var t=1;if("horizontal"==o.settings.mode&&o.settings.slideWidth>0)if(o.viewport.width()<o.minThreshold)t=o.settings.minSlides;else if(o.viewport.width()>o.maxThreshold)t=o.settings.maxSlides;else{var e=o.children.first().width();t=Math.floor(o.viewport.width()/e)}else"vertical"==o.settings.mode&&(t=o.settings.minSlides);return t},x=function(){var t=0;if(o.settings.moveSlides>0)if(o.settings.infiniteLoop)t=o.children.length/m();else for(var e=0,i=0;e<o.children.length;)++t,e=i+f(),i+=o.settings.moveSlides<=f()?o.settings.moveSlides:f();else t=Math.ceil(o.children.length/f());return t},m=function(){return o.settings.moveSlides>0&&o.settings.moveSlides<=f()?o.settings.moveSlides:f()},S=function(){if(o.children.length>o.settings.maxSlides&&o.active.last&&!o.settings.infiniteLoop){if("horizontal"==o.settings.mode){var t=o.children.last(),e=t.position();b(-(e.left-(o.viewport.width()-t.width())),"reset",0)}else if("vertical"==o.settings.mode){var i=o.children.length-o.settings.minSlides,e=o.children.eq(i).position();b(-e.top,"reset",0)}}else{var e=o.children.eq(o.active.index*m()).position();o.active.index==x()-1&&(o.active.last=!0),void 0!=e&&("horizontal"==o.settings.mode?b(-e.left,"reset",0):"vertical"==o.settings.mode&&b(-e.top,"reset",0))}},b=function(t,e,i,s){if(o.usingCSS){var n="vertical"==o.settings.mode?"translate3d(0, "+t+"px, 0)":"translate3d("+t+"px, 0, 0)";r.css("-"+o.cssPrefix+"-transition-duration",i/1e3+"s"),"slide"==e?(r.css(o.animProp,n),r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),D()})):"reset"==e?r.css(o.animProp,n):"ticker"==e&&(r.css("-"+o.cssPrefix+"-transition-timing-function","linear"),r.css(o.animProp,n),r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),b(s.resetValue,"reset",0),N()}))}else{var a={};a[o.animProp]=t,"slide"==e?r.animate(a,i,o.settings.easing,function(){D()}):"reset"==e?r.css(o.animProp,t):"ticker"==e&&r.animate(a,speed,"linear",function(){b(s.resetValue,"reset",0),N()})}},w=function(){for(var e="",i=x(),s=0;i>s;s++){var n="";o.settings.buildPager&&t.isFunction(o.settings.buildPager)?(n=o.settings.buildPager(s),o.pagerEl.addClass("bx-custom-pager")):(n=s+1,o.pagerEl.addClass("bx-default-pager")),e+='<div class="bx-pager-item"><a href="" data-slide-index="'+s+'" class="bx-pager-link">'+n+"</a></div>"}o.pagerEl.html(e)},T=function(){o.settings.pagerCustom?o.pagerEl=t(o.settings.pagerCustom):(o.pagerEl=t('<div class="bx-pager" />'),o.settings.pagerSelector?t(o.settings.pagerSelector).html(o.pagerEl):o.controls.el.addClass("bx-has-pager").append(o.pagerEl),w()),o.pagerEl.delegate("a","click",q)},C=function(){o.controls.next=t('<a class="bx-next" href="">'+o.settings.nextText+"</a>"),o.controls.prev=t('<a class="bx-prev" href="">'+o.settings.prevText+"</a>"),o.controls.next.bind("click",y),o.controls.prev.bind("click",z),o.settings.nextSelector&&t(o.settings.nextSelector).append(o.controls.next),o.settings.prevSelector&&t(o.settings.prevSelector).append(o.controls.prev),o.settings.nextSelector||o.settings.prevSelector||(o.controls.directionEl=t('<div class="bx-controls-direction" />'),o.controls.directionEl.append(o.controls.prev).append(o.controls.next),o.controls.el.addClass("bx-has-controls-direction").append(o.controls.directionEl))},E=function(){o.controls.start=t('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+o.settings.startText+"</a></div>"),o.controls.stop=t('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+o.settings.stopText+"</a></div>"),o.controls.autoEl=t('<div class="bx-controls-auto" />'),o.controls.autoEl.delegate(".bx-start","click",k),o.controls.autoEl.delegate(".bx-stop","click",M),o.settings.autoControlsCombine?o.controls.autoEl.append(o.controls.start):o.controls.autoEl.append(o.controls.start).append(o.controls.stop),o.settings.autoControlsSelector?t(o.settings.autoControlsSelector).html(o.controls.autoEl):o.controls.el.addClass("bx-has-controls-auto").append(o.controls.autoEl),A(o.settings.autoStart?"stop":"start")},P=function(){o.children.each(function(){var e=t(this).find("img:first").attr("title");void 0!=e&&(""+e).length&&t(this).append('<div class="bx-caption"><span>'+e+"</span></div>")})},y=function(t){o.settings.auto&&r.stopAuto(),r.goToNextSlide(),t.preventDefault()},z=function(t){o.settings.auto&&r.stopAuto(),r.goToPrevSlide(),t.preventDefault()},k=function(t){r.startAuto(),t.preventDefault()},M=function(t){r.stopAuto(),t.preventDefault()},q=function(e){o.settings.auto&&r.stopAuto();var i=t(e.currentTarget),s=parseInt(i.attr("data-slide-index"));s!=o.active.index&&r.goToSlide(s),e.preventDefault()},I=function(e){var i=o.children.length;return"short"==o.settings.pagerType?(o.settings.maxSlides>1&&(i=Math.ceil(o.children.length/o.settings.maxSlides)),o.pagerEl.html(e+1+o.settings.pagerShortSeparator+i),void 0):(o.pagerEl.find("a").removeClass("active"),o.pagerEl.each(function(i,s){t(s).find("a").eq(e).addClass("active")}),void 0)},D=function(){if(o.settings.infiniteLoop){var t="";0==o.active.index?t=o.children.eq(0).position():o.active.index==x()-1&&o.carousel?t=o.children.eq((x()-1)*m()).position():o.active.index==o.children.length-1&&(t=o.children.eq(o.children.length-1).position()),"horizontal"==o.settings.mode?b(-t.left,"reset",0):"vertical"==o.settings.mode&&b(-t.top,"reset",0)}o.working=!1,o.settings.onSlideAfter(o.children.eq(o.active.index),o.oldIndex,o.active.index)},A=function(t){o.settings.autoControlsCombine?o.controls.autoEl.html(o.controls[t]):(o.controls.autoEl.find("a").removeClass("active"),o.controls.autoEl.find("a:not(.bx-"+t+")").addClass("active"))},W=function(){1==x()?(o.controls.prev.addClass("disabled"),o.controls.next.addClass("disabled")):!o.settings.infiniteLoop&&o.settings.hideControlOnEnd&&(0==o.active.index?(o.controls.prev.addClass("disabled"),o.controls.next.removeClass("disabled")):o.active.index==x()-1?(o.controls.next.addClass("disabled"),o.controls.prev.removeClass("disabled")):(o.controls.prev.removeClass("disabled"),o.controls.next.removeClass("disabled")))},H=function(){o.settings.autoDelay>0?setTimeout(r.startAuto,o.settings.autoDelay):r.startAuto(),o.settings.autoHover&&r.hover(function(){o.interval&&(r.stopAuto(!0),o.autoPaused=!0)},function(){o.autoPaused&&(r.startAuto(!0),o.autoPaused=null)})},L=function(){var e=0;if("next"==o.settings.autoDirection)r.append(o.children.clone().addClass("bx-clone"));else{r.prepend(o.children.clone().addClass("bx-clone"));var i=o.children.first().position();e="horizontal"==o.settings.mode?-i.left:-i.top}b(e,"reset",0),o.settings.pager=!1,o.settings.controls=!1,o.settings.autoControls=!1,o.settings.tickerHover&&!o.usingCSS&&o.viewport.hover(function(){r.stop()},function(){var e=0;o.children.each(function(){e+="horizontal"==o.settings.mode?t(this).outerWidth(!0):t(this).outerHeight(!0)});var i=o.settings.speed/e,s="horizontal"==o.settings.mode?"left":"top",n=i*(e-Math.abs(parseInt(r.css(s))));N(n)}),N()},N=function(t){speed=t?t:o.settings.speed;var e={left:0,top:0},i={left:0,top:0};"next"==o.settings.autoDirection?e=r.find(".bx-clone").first().position():i=o.children.first().position();var s="horizontal"==o.settings.mode?-e.left:-e.top,n="horizontal"==o.settings.mode?-i.left:-i.top,a={resetValue:n};b(s,"ticker",speed,a)},O=function(){o.touch={start:{x:0,y:0},end:{x:0,y:0}},o.viewport.bind("touchstart",X)},X=function(t){if(o.working)t.preventDefault();else{o.touch.originalPos=r.position();var e=t.originalEvent;o.touch.start.x=e.changedTouches[0].pageX,o.touch.start.y=e.changedTouches[0].pageY,o.viewport.bind("touchmove",Y),o.viewport.bind("touchend",V)}},Y=function(t){var e=t.originalEvent,i=Math.abs(e.changedTouches[0].pageX-o.touch.start.x),s=Math.abs(e.changedTouches[0].pageY-o.touch.start.y);if(3*i>s&&o.settings.preventDefaultSwipeX?t.preventDefault():3*s>i&&o.settings.preventDefaultSwipeY&&t.preventDefault(),"fade"!=o.settings.mode&&o.settings.oneToOneTouch){var n=0;if("horizontal"==o.settings.mode){var r=e.changedTouches[0].pageX-o.touch.start.x;n=o.touch.originalPos.left+r}else{var r=e.changedTouches[0].pageY-o.touch.start.y;n=o.touch.originalPos.top+r}b(n,"reset",0)}},V=function(t){o.viewport.unbind("touchmove",Y);var e=t.originalEvent,i=0;if(o.touch.end.x=e.changedTouches[0].pageX,o.touch.end.y=e.changedTouches[0].pageY,"fade"==o.settings.mode){var s=Math.abs(o.touch.start.x-o.touch.end.x);s>=o.settings.swipeThreshold&&(o.touch.start.x>o.touch.end.x?r.goToNextSlide():r.goToPrevSlide(),r.stopAuto())}else{var s=0;"horizontal"==o.settings.mode?(s=o.touch.end.x-o.touch.start.x,i=o.touch.originalPos.left):(s=o.touch.end.y-o.touch.start.y,i=o.touch.originalPos.top),!o.settings.infiniteLoop&&(0==o.active.index&&s>0||o.active.last&&0>s)?b(i,"reset",200):Math.abs(s)>=o.settings.swipeThreshold?(0>s?r.goToNextSlide():r.goToPrevSlide(),r.stopAuto()):b(i,"reset",200)}o.viewport.unbind("touchend",V)},B=function(){var e=t(window).width(),i=t(window).height();(a!=e||l!=i)&&(a=e,l=i,r.redrawSlider())};return r.goToSlide=function(e,i){if(!o.working&&o.active.index!=e)if(o.working=!0,o.oldIndex=o.active.index,o.active.index=0>e?x()-1:e>=x()?0:e,o.settings.onSlideBefore(o.children.eq(o.active.index),o.oldIndex,o.active.index),"next"==i?o.settings.onSlideNext(o.children.eq(o.active.index),o.oldIndex,o.active.index):"prev"==i&&o.settings.onSlidePrev(o.children.eq(o.active.index),o.oldIndex,o.active.index),o.active.last=o.active.index>=x()-1,o.settings.pager&&I(o.active.index),o.settings.controls&&W(),"fade"==o.settings.mode)o.settings.adaptiveHeight&&o.viewport.height()!=p()&&o.viewport.animate({height:p()},o.settings.adaptiveHeightSpeed),o.children.filter(":visible").fadeOut(o.settings.speed).css({zIndex:0}),o.children.eq(o.active.index).css("zIndex",51).fadeIn(o.settings.speed,function(){t(this).css("zIndex",50),D()});else{o.settings.adaptiveHeight&&o.viewport.height()!=p()&&o.viewport.animate({height:p()},o.settings.adaptiveHeightSpeed);var s=0,n={left:0,top:0};if(!o.settings.infiniteLoop&&o.carousel&&o.active.last)if("horizontal"==o.settings.mode){var a=o.children.eq(o.children.length-1);n=a.position(),s=o.viewport.width()-a.outerWidth()}else{var l=o.children.length-o.settings.minSlides;n=o.children.eq(l).position()}else if(o.carousel&&o.active.last&&"prev"==i){var d=1==o.settings.moveSlides?o.settings.maxSlides-m():(x()-1)*m()-(o.children.length-o.settings.maxSlides),a=r.children(".bx-clone").eq(d);n=a.position()}else if("next"==i&&0==o.active.index)n=r.find("> .bx-clone").eq(o.settings.maxSlides).position(),o.active.last=!1;else if(e>=0){var c=e*m();n=o.children.eq(c).position()}if("undefined"!=typeof n){var g="horizontal"==o.settings.mode?-(n.left-s):-n.top;b(g,"slide",o.settings.speed)}}},r.goToNextSlide=function(){if(o.settings.infiniteLoop||!o.active.last){var t=parseInt(o.active.index)+1;r.goToSlide(t,"next")}},r.goToPrevSlide=function(){if(o.settings.infiniteLoop||0!=o.active.index){var t=parseInt(o.active.index)-1;r.goToSlide(t,"prev")}},r.startAuto=function(t){o.interval||(o.interval=setInterval(function(){"next"==o.settings.autoDirection?r.goToNextSlide():r.goToPrevSlide()},o.settings.pause),o.settings.autoControls&&1!=t&&A("stop"))},r.stopAuto=function(t){o.interval&&(clearInterval(o.interval),o.interval=null,o.settings.autoControls&&1!=t&&A("start"))},r.getCurrentSlide=function(){return o.active.index},r.getSlideCount=function(){return o.children.length},r.redrawSlider=function(){o.children.add(r.find(".bx-clone")).outerWidth(u()),o.viewport.css("height",p()),o.settings.ticker||S(),o.active.last&&(o.active.index=x()-1),o.active.index>=x()&&(o.active.last=!0),o.settings.pager&&!o.settings.pagerCustom&&(w(),I(o.active.index))},r.destroySlider=function(){o.initialized&&(o.initialized=!1,t(".bx-clone",this).remove(),o.children.each(function(){void 0!=t(this).data("origStyle")?t(this).attr("style",t(this).data("origStyle")):t(this).removeAttr("style")}),void 0!=t(this).data("origStyle")?this.attr("style",t(this).data("origStyle")):t(this).removeAttr("style"),t(this).unwrap().unwrap(),o.controls.el&&o.controls.el.remove(),o.controls.next&&o.controls.next.remove(),o.controls.prev&&o.controls.prev.remove(),o.pagerEl&&o.pagerEl.remove(),t(".bx-caption",this).remove(),o.controls.autoEl&&o.controls.autoEl.remove(),clearInterval(o.interval),o.settings.responsive&&t(window).unbind("resize",B))},r.reloadSlider=function(t){void 0!=t&&(n=t),r.destroySlider(),d()},d(),this}}(jQuery);function Activity(e,t,n,r,i,s,o){this.activityCode=e;this.points=t;this.climit=n;this.maxcap=r;this.groupCode=i;this.activityName=s;this.firstFlag=o}function dataStore(){var e;var t;var n;var r;var s;var o;var u;var a;var f;var l;var c;this.init=function(){this.data=$.jStorage.get("bp");this.requestStatus=false;if(this.data===null){this.data=new Object;this.data[DBACTIVITY]=new Object;this.data[DBBADGES]=new Object;this.data[DBBADGEACTIVITYCOUNT]=new Object;this.data[DBFIRSTACTIVITY]=0;this.data[DBPOINTS]=0;this.data[ACTIVITYCOUNT]=0;this.data[DBTOTAL]=new Object;this.save()}this.setTemplate();this.setMiniNotification();this.setOpenMiniTemplate();this.setRewardTemplate();this.setCurrentDate();this.setChannel();this.prepareNotification();this.slider=null};this.addActivity=function(e){if(ActivityMapper[this.channel][e]===undefined){console.log("activity not found "+e);return false}e=ActivityMapper[this.channel][e];var t=ActivityMaster[this.channel][e];var n=this.getBadgeActivityCount(t);var r=this.getLatestActivityTime(t);if((t.climit<r||r===0)&&t.maxcap>n){this.saveActivity(t);n=n+1;if(t.firstFlag===1&&n===1&&myDataStore.data[DBPOINTS]<10){this.addActivity("register")}}};this.getActivityCount=function(e){if(this.data[DBACTIVITY][e.activityCode][this.currentDate][TIMESTAMP].length===undefined){return 0}};this.getLatestActivityTime=function(e){if(this.data[DBACTIVITY][e.activityCode]===undefined){var t=new Object;t[this.currentDate]=0;this.data[DBACTIVITY][e.activityCode]=t;this.save();return 0}else if(this.data[DBACTIVITY][e.activityCode][this.currentDate]===undefined){this.data[DBACTIVITY][e.activityCode][this.currentDate]=0;this.save();return 0}else if(this.data[DBACTIVITY][e.activityCode][this.currentDate]===0){return 0}else{var n=this.data[DBACTIVITY][e.activityCode][this.currentDate][this.data[DBACTIVITY][e.activityCode][this.currentDate].length-1];return((new Date).getTime()-n)/1e3}};this.getBadgeActivityCount=function(e){if(this.data[DBBADGEACTIVITYCOUNT][e.groupCode]===undefined){var t=new Object;t[this.currentDate]={c:0,p:0};this.data[DBBADGEACTIVITYCOUNT][e.groupCode]=t;this.data[DBTOTAL][e.groupCode]={c:0,p:0};this.save();return 0}else if(this.data[DBBADGEACTIVITYCOUNT][e.groupCode][this.currentDate]===undefined){this.data[DBBADGEACTIVITYCOUNT][e.groupCode][this.currentDate]={c:0,p:0};this.save();return 0}else{return this.data[DBBADGEACTIVITYCOUNT][e.groupCode][this.currentDate][DBACTIVITYCOUNT]}};this.saveActivity=function(e){if(this.data[DBACTIVITY][e.activityCode][this.currentDate]===0){this.data[DBACTIVITY][e.activityCode][this.currentDate]=new Array}this.data[DBACTIVITY][e.activityCode][this.currentDate].push((new Date).getTime());this.data[DBBADGEACTIVITYCOUNT][e.groupCode][this.currentDate][DBACTIVITYCOUNT]=this.data[DBBADGEACTIVITYCOUNT][e.groupCode][this.currentDate][DBACTIVITYCOUNT]+1;this.data[DBBADGEACTIVITYCOUNT][e.groupCode][this.currentDate][DBPOINTS]=this.data[DBBADGEACTIVITYCOUNT][e.groupCode][this.currentDate][DBPOINTS]+e.points;if(this.data[DBFIRSTACTIVITY]===0){this.data[DBFIRSTACTIVITY]=this.currentDate}this.data[DBPOINTS]=this.data[DBPOINTS]+e.points;this.data[DBTOTAL][e.groupCode][DBPOINTS]=this.data[DBTOTAL][e.groupCode][DBPOINTS]+e.points;this.data[DBTOTAL][e.groupCode][DBACTIVITYCOUNT]=this.data[DBTOTAL][e.groupCode][DBACTIVITYCOUNT]+1;this.data[ACTIVITYCOUNT]=this.data[ACTIVITYCOUNT]+1;this.saveBadges(e);this.save();if(this.data[ACTIVITYCOUNT]%NOTIFICATIONTHESHOLD===0){this.notificationType="activity"}};this.saveBadges=function(e){var t=BadgesMaster[this.channel][e.groupCode];if(this.data[DBTOTAL][e.groupCode][DBACTIVITYCOUNT]>=t[1].threshold&&this.data[DBTOTAL][e.groupCode][DBACTIVITYCOUNT]<t[2].threshold&&this.data[DBBADGES][e.groupCode]===undefined){this.data[DBBADGES][e.groupCode]=new Object;this.data[DBBADGES][e.groupCode][DBNAME]=t[1].name;this.data[DBBADGES][e.groupCode]["d"]=t[1].description;this.data[DBBADGES][e.groupCode]["l"]=1;this.data[DBBADGES][e.groupCode]["i"]=t[1].img;this.data[DBBADGES][e.groupCode]["priority"]=t[1].priority;this.save();this.notificationType="activity"}else if(this.data[DBTOTAL][e.groupCode][DBACTIVITYCOUNT]>=t[2].threshold){if(this.data[DBBADGES][e.groupCode]===undefined){this.data[DBBADGES][e.groupCode]=new Object;this.data[DBBADGES][e.groupCode][DBNAME]=t[2].name;this.data[DBBADGES][e.groupCode]["d"]=t[2].description;this.data[DBBADGES][e.groupCode]["l"]=2;this.data[DBBADGES][e.groupCode]["i"]=t[2].img;this.data[DBBADGES][e.groupCode]["priority"]=t[1].priority;this.save()}else if(this.data[DBBADGES][e.groupCode]["l"]===1){this.data[DBBADGES][e.groupCode][DBNAME]=t[2].name;this.data[DBBADGES][e.groupCode]["d"]=t[2].description;this.data[DBBADGES][e.groupCode]["l"]=2;this.data[DBBADGES][e.groupCode]["i"]=t[2].img;this.data[DBBADGES][e.groupCode]["priority"]=t[1].priority;this.save();this.notificationType="activity"}}};this.save=function(){$.jStorage.set("bp",this.data)};this.checkValidity=function(){var e=this.getSevelDaysOldTimeStamp(6);var t=this.getSevelDaysOldTimeStamp(7);if(this.data[DBFIRSTACTIVITY]!==0&&this.data[DBFIRSTACTIVITY]<=t){this.purge();this.init()}else if(this.data[DBFIRSTACTIVITY]!==0&&this.data[DBFIRSTACTIVITY]<=e){if($.jStorage.get("expire")==null){myDataStore.displayReward(3,myDataStore.data[DBPOINTS]);$.jStorage.set("expire",1)}}};this.purge=function(){$.jStorage.deleteKey("bp")};this.setCurrentDate=function(){var e=new Date;var t=new Date(e.getFullYear(),e.getMonth(),e.getDate()-1);this.currentDate=t.getTime()};this.getSevelDaysOldTimeStamp=function(e){var t=new Date;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate()-e);return n.getTime()};this.setChannel=function(){var e=window.location.hostname;this.channel=ChannelMaster[e];switch(this.channel){case"05":ActivityMaster[this.channel]=new Object;ActivityMapper[this.channel]=new Object;ActivityMaster[this.channel][15405]=new Activity(15405,1,120,30,15405,"read",0);ActivityMaster[this.channel][16005]=new Activity(16005,0,1e4,1,16005,"register",0);ActivityMapper[this.channel]["read"]=15405;ActivityMapper[this.channel]["register"]=16005;ActivityMaster[this.channel][18305]=new Activity(18305,2,420,25,15405,"view_photo",0);ActivityMapper[this.channel]["view_photo"]=18305;ActivityMaster[this.channel][18605]=new Activity(18605,2,30,10,15405,"watch_video",0);ActivityMapper[this.channel]["watch_video"]=18605;ActivityMaster[this.channel][18505]=new Activity(18505,1,7200,12,18505,"visit",1);ActivityMapper[this.channel]["visit"]=18505;BadgesMaster[this.channel]=new Object;BadgesMaster[this.channel][16005]={1:{priority:3,threshold:1,img:"http://static.rewards.indiatimes.com/images/member.png",name:"Member",description:"Register and earn the Member Badge. Members can earn & redeem points on <a href='http://www.timespoints.com' target='_blank'>timespoints.com</a>.",notificationThreshold:1e3},2:{priority:3,threshold:1e5,img:"http://static.rewards.indiatimes.com/images/member.png",name:"Member",description:"Register and earn the Member Badge. Members can earn & redeem points on <a href='http://www.timespoints.com' target='_blank'>timespoints.com</a>.",notificationThreshold:1e3}};BadgesMaster[this.channel][15405]={1:{priority:1,threshold:5,img:"http://static.rewards.indiatimes.com/images/newsking.png",name:"News King",description:"Read articles, watch exclusive videos or browse through our photo gallery to become a News King.",notificationThreshold:5},2:{priority:1,threshold:10,img:"http://static.rewards.indiatimes.com/images/newsking.png",name:"News King",description:"Read articles, watch exclusive videos or browse through our photo gallery to become a News King.",notificationThreshold:5}};BadgesMaster[this.channel][18505]={1:{priority:2,threshold:5,img:"http://static.rewards.indiatimes.com/images/ff.png",name:"Frequent Flyer",description:"Make timesofindia.com your news hotspot. Visit the site regularly to earn this badge.",notificationThreshold:5},2:{priority:2,threshold:10,img:"http://static.rewards.indiatimes.com/images/ff.png",name:"Frequent Flyer",description:"Make timesofindia.com your news hotspot. Visit the site regularly to earn this badge.",notificationThreshold:5}};break}};this.setMiniNotification=function(){this.miniTemplate='<div class="TPBlueBand"><div class="TPLogoIcon"></div><div class="TPPoints">{{{points}}}</div><div class="TPTitle">Times Points Earned</div><div class="TPRightIcons"><div class="TPSettingsIcon" onclick="myDataStore.closeAll();myDataStore.displayNotification();"></div><div class="TPTopIcon" onclick="myDataStore.closeAll(true);myDataStore.OpenTPBottomPop();"></div></div></div>'};this.setOpenMiniTemplate=function(){this.openMiniTemplate='<div class="TPPopCont" id = "miniTemplate"><div class="TPPointsBox"><div class="TPPointsBG">{{{points}}}</div></div><div class="TPPopRightBox"><div class="SelectedLinkRow" id="badgesEarned" onclick="myDataStore.displayOpenMiniNotification();"><div class="Lefticon"></div><div class="RightText">Earned Badges</div></div><div class="LinkRow" id="productEarned"><div class="Lefticon"></div>'+'<div class="RightText" onclick="myDataStore.displayOpenProduct();">What my Points can buy?</div></div>'+'<div class="LinkRow">'+'<div class="Lefticon"></div>'+'<div class="RightText" onclick="window.open(\'http://timesofindia.indiatimes.com/abouttimesrewards.cms\',\'_blank\');">About Times Points</div></div>'+'<div class="ClaimButton"><div class="ClaimButtonLink marginT12" onClick="myDataStore.closeAll();javascript:loadPopup(4);">Claim Points Now!</div></div></div>'+'<div class="TPMidCrsl"><div class="{{#active}}TPMidCrslLeftArrowActive{{/active}}" {{#active}}onclick = "myDataStore.preSlide();"{{/active}}></div>'+'<div class="{{#active}}TPMidCrslRightArrowActive{{/active}}" {{#active}}onclick = "myDataStore.nextSlide();"{{/active}}></div>'+'<div class="TPMidCrslMidCont"><div class="TPMidCrslMidOuter">{{#badges}}{{#img}}<div class="CrslCol" {{#single}} style="width:100%;"{{/single}}>'+'<div class="TPBadgeImage"><img src="{{{img}}}" align="absmiddle"/></div>'+'<div class="TPBadgeTitle">{{{text}}}</div><div class="TPBadgeDesc {{#left}}{{{left}}}{{/left}}">{{{desc}}}</div></div>{{/img}}{{/badges}}</div></div></div></div>'};this.setRewardTemplate=function(){this.rewardTemplate='<div id="TPMainPopDiv">'+'<div class="TPPopContent">'+'<div class="TPHeaderLinks">TIMES POINTS UPDATE</div>'+' <div class="PointBadgeIcon">{{{points}}}</div>'+'<div class="full_width">'+'<div class="ImgtxtBox MarginB10">'+'<div class="Image">{{#badges}}{{#img}}'+'<div class="ImgTitle"><img width="71px;" src="{{{img}}}" align="absmiddle">'+'<div><span class="TxtBold">{{{text}}}</span>{{#bpoints}}<span class="TxtNrml">({{{bpoints}}} Points)</span>{{/bpoints}}'+'</div>'+'</div>'+'{{/img}}{{/badges}}'+'</div>'+'<div class="Txt">{{{description}}}</div>'+'</div>'+'</div>'+'<div class="BottomLinks">'+'<div class="LeftCont" id="ShowMessage"></div>'+'</div>'+'<div class="Crossicon" onclick="$(\'#notifymain\').hide();"></div>'+'</div>'+'</div>'};this.setTemplate=function(){this.template='<div id="TPMainPopDiv"><div class="TPPopContent"><div class="TPHeaderLinks">TIMES POINTS UPDATE</div><div class="PointBadgeIcon">{{{points}}}</div><div class="full_width"><div class="ImgtxtBox MarginB10"><div class="Image">{{#badges}}{{#img}}<div class="ImgTitle"><img width = "71px;" src="{{{img}}}" align="absmiddle"><div><span class="TxtBold">{{{text}}}</span>{{#bpoints}}<span class="TxtNrml">({{{bpoints}}} Points)</span>{{/bpoints}}</div></div>{{/img}}{{/badges}}</div><div class="Txt">{{{description}}}</div></div></div><div class="ClaimButton"><div class="ClaimButtonLink" onClick="myDataStore.closeAll();javascript:loadPopup(4);">Claim Your Times Points and Badges Now!</div></div><div class="BottomLinks"><div class="LeftCont" id="ShowMessage"></div></div><div class="Crossicon" onclick="$(\'#notifymain\').hide();"></div></div></div>'};this.hideNotification=function(){$("#notifymain").hide();$.jStorage.set("notify",1)};this.checkDontShow=function(){if($.jStorage.get("notify")==null){return false}else{return true}};this.checkShowCredit=function(){if($.jStorage.get("credit")==null){return false}else{return true}};this.scrollLeaderBoard=function(){document.getElementById("timesPointHolder").scrollIntoView(true);document.documentElement.scrollTop-=50;document.body.scrollTop-=50};this.prepareNotification=function(){var e="@font-face {font-family: 'robotoregular';src: url('http://static.rewards.indiatimes.com/js/Fonts/Roboto-Regular-webfont.eot');src: url('http://static.rewards.indiatimes.com/js/Fonts/Roboto-Regular-webfont.eot?#iefix') format('embedded-opentype'),url('http://static.rewards.indiatimes.com/js/Fonts/Roboto-Regular-webfont.woff') format('woff'),url('http://static.rewards.indiatimes.com/js/Fonts/Roboto-Regular-webfont.ttf') format('truetype'),url('http://static.rewards.indiatimes.com/js/Fonts/Roboto-Regular-webfont.svg#robotoregular') format('svg');font-weight: normal;font-style: normal;}#notifymain{font-family: 'robotoregular', 'arial'; display:none; position:fixed; height:100%; width:100%; top:0; bottom:0; background:url('http://static.rewards.indiatimes.com/js/BlackBgTrans.png'); z-index:100006;}#notifymain a{font-size:14px !important;} #TPMainPopDiv{max-width: 80%;width:auto;position: fixed;top: 50%;z-index: 100001;border: 3px solid #fff;} .TPHeaderLinks{display:block; overflow:hidden; padding:5px 10px; background:#e1e1e1; border-bottom:1px solid #d7d7d7; overflow:hidden; color:#1c1c1c; font-size:16px; text-transform:uppercase; text-align:center; font-weight:bold;} .Crossicon {position: absolute;top: 1px;right: 1px;cursor: pointer;background: url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -30px -548px;width: 32px;height: 32px;} .TPPopContent{display: block;max-width: 600px;background: #fff;position: relative;color: #fff;font-size: 12px;position: relative;border:2px solid #cacaca} .TPPopContent a{color:#0B4E9D !important}.PointBadgeIcon{width:86px; height:65px; background:url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -3px -452px; position:absolute; left:-40px; top:-40px; text-shadow: 1px 1px #e6e6e6; color:#1c1c1c; padding-top:28px; font-weight:bold; text-align:center; font-size:25px;}.TPPopContent .ImgtxtBox{display: block; overflow: hidden; padding:10px  15px 0 15px;} .ImgtxtBox .Image{float:left; width:100%; text-align:center; margin:0 0 10px 0;} .ImgtxtBox .Image .ImgTitle{width:160px; display:inline-block; margin:5px; text-align:center;}.ImgtxtBox .Image .ImgTitle img{margin:0 20px;}.ImgtxtBox .Image .ImgTitle .TxtBold{float:left; width:100%; font-size:14px; color:#1c1c1c; font-weight:normal; padding:5px 0 0 0;}.ImgtxtBox .Image .ImgTitle .TxtNrml{ float:left; width:100%; font-size:11px; color:#4f4f4f;}.ImgtxtBox .Txt{float:left; font-size:14px; margin:10px 0; color:#1c1c1c; line-height:20px;} .ImgtxtBox .Txt1{float: left; width: 100%; margin-top: 5px; text-align: center;} .MarginB10{margin-bottom:10px;} .ClaimButton{width:100%; padding:5px 0 15px 0; text-align:center;} .TextAlingL{text-align:left !important;} .marginT12{margin-top:12px;}.ClaimButton .ClaimButtonLink{cursor:pointer; display:inline-block; font-weight:normal; padding:8px 15px; color:#fff; font-size:15px; background: #0b4e9d;}.TPBottomPop{font-family: 'robotoregular', 'arial'; position:fixed; height:0px; border-top:1px solid #666666; bottom:0; width:100%; background:#f1f2f4; box-shadow: -2px -1px 8px #000; -moz-box-shadow: -2px -1px 8px #000; -webkit-box-shadow: 0px -1px 10px #000000;z-index:10000;}.TPBottomPopCont{width:1002px; margin:0 auto; position:relative;}.TPBlueBand{background:#0b4e9d; color:#fff; width:305px; position:absolute; top:-35px; height:35px; right:0; -webkit-border-top-left-radius: 4px;   -webkit-border-top-right-radius: 4px; -moz-border-radius-topleft: 4px;   -moz-border-radius-topright: 4px; border-top-left-radius: 4px;   border-top-right-radius: 4px;}.TPTitle{float:left; width:150px; font-size:12px; text-transform:uppercase; line-height:34px; padding-left:2px;}.TPLogoIcon{float:left; width:35px; height:35px; background:url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -21px 3px;}.TPPoints{float:left; width:auto; border:1px solid #083e7e;  font-size:16px; font-weight:normal; background:#07468d; padding:4px 5px 6px 5px; height:15px; margin:4px; -webkit-border-radius: 4px; -moz-border-radius:4px; }.TPRightIcons{float:right; width:auto; -webkit-border-top-right-radius: 4px;  border-top-right-radius: 4px; -moz-border-radius-topright: 4px; background:#07366e;}.TPRightIcons .TPSettingsIcon{float:left; width:35px; height:35px; background:url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -27px -45px; border-right:1px solid #244266; border-left:1px solid #4375b2; cursor:pointer;}.TPRightIcons .TPTopIcon{float:left; width:35px; height:35px; background:url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -27px -89px; border-left:1px solid #4375b2; cursor:pointer;}.TPRightIcons .TPSettingsIcon:hover{background:#0b4e9d url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -27px -45px;}.TPRightIcons .TPTopIcon:hover{background:#0b4e9d url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -27px -89px;  -webkit-border-top-right-radius: 4px;  border-top-right-radius: 4px; -moz-border-radius-topright: 4px; }.TPRightIcons .TPBottomIcon{float:left; width:35px; height:35px; background:url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -27px -129px; border-left:1px solid #396eae; cursor:pointer;}.TPRightIcons .TPBottomIcon:hover{background:#0b4e9d url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -27px -129px; }.TPPointsBox{float:left; width:152px; border-left:1px solid #b8b8b8; border-right:1px solid #b8b8b8; height:165px; background:#d5dde8;}.TPPointsBG{width:152px; height:60px; float:left; margin-top:25px; background:url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat 28px -427px; font-weight:bold; text-align:center; font-size:24px; color:#1c1c1c; padding-top:51px;}.TPPopRightBox{float:right; width:303px; border-right:1px solid #acacac; border-left:1px solid #acacac; height:165px; background:#d5dde8;}.TPPopRightBox .LinkRow{float:left; font-weight:normal; width:96%; font-size:11px; text-transform:uppercase; padding:10px 2% 10px 2%; cursor:pointer;}.TPPopRightBox .LinkRow .Lefticon{background:url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -32px -198px; width:25px; height:14px; float:left;}.TPPopRightBox .LinkRow .RightText{display:block; overflow:hidden;}.TPPopRightBox .SelectedLinkRow{float:left; position:relative; font-weight:bold; width:96%; font-size:11px; text-transform:uppercase; padding:10px 2% 10px 2%; cursor:pointer;  border-bottom:1px solid #b6b9bd; background:#f1f2f4;}.TPPopRightBox .SelectedLinkRow .Lefticon{z-index:10; background: url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -29px -162px; width:25px; position:absolute; left:-20px; top:0; height:29px;}.TPPopRightBox .SelectedLinkRow .RightText{display:block; overflow:hidden; padding-left:20px;}.TPPopRightBox .LinkRow:hover{background:#f1f2f4;}.TPMidCrsl{float:left; width:543px; background:#fff; height:165px; position:relative;}.TPMidCrsl .TPMidCrslMidCont{float:left; width:460px; margin:0 40px; height:165px; position:relative; overflow:hidden;}.TPMidCrsl .TPMidCrslLeftArrow{position:absolute; width:40px; left:10px; top:70px; background: url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -67px -260px; height:32px; cursor:pointer;}.TPMidCrsl .TPMidCrslRightArrow{position:absolute; width:40px; right:10px; top:70px; height:32px; background: url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat 0px -341px; cursor:pointer;}.TPMidCrsl .TPMidCrslLeftArrowActive{position:absolute; width:40px; left:10px; top:70px; background: url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat -67px -341px !important; height:32px; cursor:pointer;}.TPMidCrsl .TPMidCrslRightArrowActive{position:absolute; width:40px; right:10px; top:70px; height:32px; background: url('http://static.rewards.indiatimes.com/js/TOISprite.png') no-repeat 0px -260px !important;  cursor:pointer;}.TPMidCrsl .TPMidCrslMidCont .TPMidCrslMidOuter{position:absolute; float:left; height:165px;}.TPMidCrslMidOuter .CrslCol a{color:#0B4E9D} .CrslCol{float:left; width:220px; height:165px; margin:0 5px; text-align:center;}.CrslCol .TPBadgeImage{float:left; width:100%; height:70px; padding:10px 0 5px 0;}.TPBadgeImage img{max-width:71px; max-height:71px;}.CrslCol .TPBadgeTitle{font-size:14px; float:left; width:100%; font-weight:bold; color:#1c1c1c;}.CrslCol .TPBadgeDesc{font-size:12px; float:left; width:90%; padding:3px 5%; height:165px; color:#444444;}";var t=document.createTextNode(e);var n=document.createElement("style");n.type="text/css";n.appendChild(t);document.getElementsByTagName("head")[0].appendChild(n)};this.displayReward=function(e,t){if($("#notifymain").length<=0){$("body").append('<div id="notifymain">')}var n=new Object;n["badges"]=new Array;n.badges[0]={img:"http://static.rewards.indiatimes.com/js/CrownIcon.png"};n.points=t;if(e===1){n.description="You were just credited "+t+" Times Points for logging in to timesofindia.com! Your pre login points are credited only once so always remember to log in, and earn points every day."}else if(e===2){n.claim=true;n.description='Thanks for logging in! Your points and badges are now saved to your account. Keep reading, sharing, and commenting to earn more points and badges. Learn more at <a href="http://www.timespoints.com" target="_blank">timespoints.com</a> <br/><I>It may take a few minutes for your points to update!</I>'}else{n.eclaim=true;n.description="Important: Your "+t+" Times Points will expire in the next 24 hours."}var r=Mustache.render(myDataStore.rewardTemplate,n);$("#notifymain").html(r);this.CenterToIPop();$("#notifymain").show()};this.displayMiniNotification=function(){var e=new Array;e["points"]=myDataStore.data[DBPOINTS];if($("#TPMainDiv").length<=0){$("body").append('<div class="TPBottomPop" ><div class="TPBottomPopCont" id="TPMainDiv"></div></div>')}var t=Mustache.render(myDataStore.miniTemplate,e);$("#TPMainDiv").html(t)};this.hideMiniNotification=function(){if($("#TPMainDiv").length>0){$("#TPMainDiv").remove()}};this.displayOpenProduct=function(){$.getJSON("http://www.timespoint.com/productFeed?category=1&productLimit=8&callback=?",null,function(a){var t=0;var n=new Object;n["badges"]=new Array;for(i=0;i<a.products.length;i++){n.badges[i]={img:a.products[i].actualImgURL,text:a.products[i].productName,desc:a.products[i].points+" Points"};t++}n.points=myDataStore.data[DBPOINTS];if(t>2){n.active="exisits"}var r=Mustache.render(myDataStore.openMiniTemplate,n);if($("#miniTemplate").length>0){$("#miniTemplate").remove()}$("#TPMainDiv").html($("#TPMainDiv").html()+r);$("#productEarned").removeClass("LinkRow");$("#productEarned").addClass("SelectedLinkRow");$("#badgesEarned").removeClass("SelectedLinkRow");$("#badgesEarned").addClass("LinkRow");$("#TPMainDiv").show();if(t>2){myDataStore.slider=$(".TPMidCrslMidOuter").bxSlider({slideWidth:220,minSlides:2,maxSlides:2,slideMargin:10})}})};this.displayOpenMiniNotification=function(){var e=0;var t=new Object;t["badges"]=new Array;for(var n in myDataStore.data[DBBADGES]){t.badges[myDataStore.data[DBBADGES][n]["priority"]]={img:myDataStore.data[DBBADGES][n]["i"],text:myDataStore.data[DBBADGES][n]["n"],desc:myDataStore.data[DBBADGES][n]["d"],priority:myDataStore.data[DBBADGES][n]["priority"],bpoints:this.data[DBTOTAL][n][DBPOINTS]};e++}t.points=myDataStore.data[DBPOINTS];if(e==1){t.single="exisits"}if(e>2){t.active="exisits"}t.left="TextAlingL";var r=Mustache.render(myDataStore.openMiniTemplate,t);if($("#miniTemplate").length>0){$("#miniTemplate").remove()}$("#TPMainDiv").html($("#TPMainDiv").html()+r);$("#TPMainDiv").show();$("#badgesEarned").removeClass("LinkRow");$("#badgesEarned").addClass("SelectedLinkRow");$("#productEarned").removeClass("SelectedLinkRow");$("#productEarned").addClass("LinkRow");if(e>2){myDataStore.slider=$(".TPMidCrslMidOuter").bxSlider({slideWidth:220,minSlides:2,maxSlides:2,slideMargin:10})}};this.displayPreLogin=function(){var e=0;var t=new Object;t["badges"]=new Array;var n=ActivityMapper[this.channel]["register"];for(var r in myDataStore.data[DBBADGES]){if(n==r){t.badges[myDataStore.data[DBBADGES][r]["priority"]]={img:myDataStore.data[DBBADGES][r]["i"],text:myDataStore.data[DBBADGES][r]["n"],desc:myDataStore.data[DBBADGES][r]["d"],priority:myDataStore.data[DBBADGES][r]["priority"]}}else{t.badges[myDataStore.data[DBBADGES][r]["priority"]]={img:myDataStore.data[DBBADGES][r]["i"],text:myDataStore.data[DBBADGES][r]["n"],desc:myDataStore.data[DBBADGES][r]["d"],priority:myDataStore.data[DBBADGES][r]["priority"],bpoints:this.data[DBTOTAL][r][DBPOINTS]}}e++}return{points:myDataStore.data[DBPOINTS],badges:e}};this.displayNotification=function(){var e=0;var t=new Object;t["badges"]=new Array;var n=ActivityMapper[this.channel]["register"];for(var r in myDataStore.data[DBBADGES]){if(n==r){t.badges[myDataStore.data[DBBADGES][r]["priority"]]={img:myDataStore.data[DBBADGES][r]["i"],text:myDataStore.data[DBBADGES][r]["n"],desc:myDataStore.data[DBBADGES][r]["d"],priority:myDataStore.data[DBBADGES][r]["priority"]}}else{t.badges[myDataStore.data[DBBADGES][r]["priority"]]={img:myDataStore.data[DBBADGES][r]["i"],text:myDataStore.data[DBBADGES][r]["n"],desc:myDataStore.data[DBBADGES][r]["d"],priority:myDataStore.data[DBBADGES][r]["priority"],bpoints:this.data[DBTOTAL][r][DBPOINTS]}}e++}t.points=myDataStore.data[DBPOINTS];var i="";if(e===1){i='Welcome to Times Points! Earn points for reading, sharing, commenting and redeem them for real goods! Learn more at <a href="http://www.timespoints.com" target="_blank">timespoints.com</a>'}else if(e===2){i="You've just earned "+myDataStore.data[DBPOINTS]+" points and the <strong>"+t.badges[1]["text"]+" and "+t.badges[3]["text"]+'</strong> badges on timesofindia.com. Login now to save them, and use your points to get real goods on <a href="http://www.timespoints.com" target="_blank">timespoints.com</a>'}else if(e===3){i="You've now earned "+myDataStore.data[DBPOINTS]+" points, and the "+"<strong>"+t.badges[1]["text"]+", "+t.badges[2]["text"]+" and "+t.badges[3]["text"]+"</strong>"+' badges on timesofindia.com. Login now to save them, and use your points to get real goods on <a href="http://www.timespoints.com" target="_blank">timespoints.com</a>'}t.description=i;var s=Mustache.render(myDataStore.template,t);if($("#notifymain").length<=0){$("body").append('<div id="notifymain">')}$("#notifymain").html(s);this.CenterToIPop();$("#notifymain").show()};this.nextSlide=function(){myDataStore.slider.goToNextSlide()};this.preSlide=function(){myDataStore.slider.goToPrevSlide()};this.RecordActivity=function(e){var t=new Image(1,1);t.src=e;setTimeout(function(){if(!t.complete||!t.naturalWidth){t.src=""}},5e3)};this.resize=function(){if($("#notifymain").css("display")!=="none"){myDataStore.CenterToIPop()}},this.scroll=function(){if($("#TPMainDiv").length>0){if($(window).scrollTop()>($(window).height()*2)){$("#TPMainDiv").show()}else{$("#TPMainDiv").hide()}}else{$("#TPMainDiv").show()}},this.CenterToIPop=function(){$("#notifymain").show();var e=$("#TPMainPopDiv").width()+30;var t=$(window).width();var n=t/2-e/2;var r=$(window).height();var i=$("#TPMainPopDiv").height();var s=(r-i-6)/2;$("#TPMainPopDiv").css("left",n);$("#TPMainPopDiv").css("top",s)};this.closeAll=function(e){if(e===undefined){$(".TPBottomPop").css("height","0px");$(".TPBottomIcon").addClass("TPTopIcon");$(".TPTopIcon").removeClass("TPBottomIcon")}if($("#notifymain").length>0){$("#notifymain").hide()}};this.OpenTPBottomPop=function(){myDataStore.displayOpenMiniNotification();$TPBottomPopHeight=$(".TPBottomPop").height();if($TPBottomPopHeight<3){$(".TPBottomPop").css("height","165px");$(".TPTopIcon").addClass("TPBottomIcon");$(".TPBottomIcon").removeClass("TPTopIcon")}else{$(".TPBottomPop").css("height","0px");$(".TPBottomIcon").addClass("TPTopIcon");$(".TPTopIcon").removeClass("TPBottomIcon")}};this.sendRequest=function(e,t){var n=$.jStorage.get("credit");if(myDataStore.data[DBPOINTS]===undefined||myDataStore.data[DBPOINTS]===0){myDataStore.RecordActivity(e);if(myDataStore.requestStatus===false&&n===null){myDataStore.requestStatus=true;this.validateUser(t)}}else{if(myDataStore.requestStatus===false){myDataStore.requestStatus=true;this.validateUser(t)}myDataStore.RecordActivity(e)}};this.validateUser=function(e){console.log({uid:e.userId,uemail:e.userId,pname:e.host,domain:e.domain});$.ajax({url:BACK_END_SERVER_BASE_URL+"/exist",crossDomain:true,type:"GET",dataType:"json",cache:false,data:{uid:e.userId,uemail:e.userId,pname:e.host,domain:e.domain},success:function(t){if(t.status===1){if(myDataStore.checkShowCredit()===false){myDataStore.displayReward(1,t.points);$.jStorage.set("credit",1)}myDataStore.purge();return true}else if(t.status===4){if(myDataStore.data[DBPOINTS]===undefined||myDataStore.data[DBPOINTS]===0){}else{myDataStore.sendData(e);return false}}},error:function(e){return false}})};this.sendData=function(e){var t="";for(var n in myDataStore.data.a){for(var r in myDataStore.data.a[n]){for(var i=0;i<myDataStore.data.a[n][r].length;i++){if(n!=16005){t=t+(t==""?"":",")+"{'spacode':"+n+", 'cdate':"+myDataStore.data.a[n][r][i]+"}"}}}}t="["+t+"]";$.ajax({url:BACK_END_SERVER_BASE_URL+"/log/data",crossDomain:true,type:"POST",dataType:"json",cache:false,contentType:"application/x-www-form-urlencoded",data:{uid:e.userId,uemail:e.userId,domain:e.domain,pname:e.host,userlogs:t},success:function(e){response=e;console.log("success. result: "+JSON.stringify(e));if(e==true){myDataStore.displayReward(2,myDataStore.data[DBPOINTS]);myDataStore.purge()}},error:function(e){response=e;console.log("error. result: "+JSON.stringify(e))}})}}function log(e,t){var n="http://rewards.indiatimes.com/bp";var r=window._tp_async_data;if(validate(r)){var i=n+"/api/alog/gal?uemail="+encodeURI(r.email);i+="&url="+encodeURI(r.URL);i+="&pcode="+encodeURI(r.host);i+="&scode="+encodeURI(r.channel);i+="&oid="+encodeURI(t);i+="&uid="+encodeURI(r.userId);i+="&ecode="+encodeURI(e);r.domain=window.location.hostname+window.location.port;myDataStore.hideMiniNotification();myDataStore.sendRequest(i,r)}else{var s=$.jStorage.get("credit");if(s==null){myDataStore.checkValidity();myDataStore.addActivity(e);myDataStore.displayMiniNotification();myDataStore.scroll()}}}function validate(e){if(e===undefined||!e.URL||!e.host||!e.channel||!e.email||!e.userId){return false}return true}var DBACTIVITY="a";var DBBADGES="b";var DBBADGEACTIVITYCOUNT="bc";var DBTOTAL="bbc";var DBNAME="n";var DBPOINTS="p";var DBACTIVITYCOUNT="c";var TIMESTAMP="t";var DBFIRSTACTIVITY="ft";var ACTIVITYCOUNT="act";var NOTIFICATIONTHESHOLD=10;var BACK_END_SERVER_BASE_URL="http://rewards.indiatimes.com/bp/api/mrg";var ActivityMaster=new Object;var BadgesMaster=new Object;var ChannelMaster=new Object;var ActivityMapper=new Object;ChannelMaster["timesofindia.indiatimes.com"]="05";ChannelMaster["toidev.indiatimes.com"]="05";ChannelMaster["jcmsdev.indiatimes.com"]="05";ChannelMaster["photogallery.indiatimes.com"]="05";var myDataStore=new dataStore;myDataStore.init();$(window).resize(function(){myDataStore.resize()});$(window).scroll(function(){myDataStore.scroll()})